{% extends "base.html" %}
{% block content %}
<h1>Admin Dashboard</h1>

<div class="kpi">
  <div class="kpi-card">
    <div class="kpi-title">Restaurants</div>
    <div class="kpi-value">{{ total_rest }}</div>
    <div class="kpi-sub">Active: {{ active_rest }}</div>
  </div>
  <div class="kpi-card">
    <div class="kpi-title">Delivery Agents</div>
    <div class="kpi-value">{{ total_agents }}</div>
    <div class="kpi-sub">Manage agents from sidebar</div>
  </div>
  <div class="kpi-card">
    <div class="kpi-title">Recent Orders</div>
    <div class="kpi-value">{{ recent_orders|length }}</div>
    <div class="kpi-sub">Last 10 shown below</div>
  </div>
</div>

<div class="card">
  <div class="card-title">Recent Orders</div>
  <div class="table">
    <div class="tr head">
      <div>#</div><div>Customer</div><div>Restaurant</div><div>Status</div><div>Total</div><div>Action</div>
    </div>
    {% for o in recent_orders %}
      <div class="tr">
        <div>#{{ o.order_id }}</div>
        <div>{{ o.user.full_name }}</div>
        <div>{{ o.restaurant.name }}</div>
        <div><span class="tag">{{ o.status }}</span></div>
        <div>PKR {{ money_str(calc_order_total(o)) }}</div>
        <div><a class="pill" href="{{ url_for('admin_orders') }}">Open Orders</a></div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}