<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Food Aggregator — Database System</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">FA</div>
      <div>
        <div class="brand-title">Food Aggregator</div>
        <div class="brand-sub">Flask + MySQL • Normalized Relational DB</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="pill" id="refreshBtn">Refresh data</button>
      <a class="pill ghost" href="https://dev.mysql.com/doc/" target="_blank" rel="noreferrer">Docs</a>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="hero-left">
        <h1>Modern food delivery database demo</h1>
        <p>
          Manage <b>Users</b>, <b>Restaurants</b>, <b>Menus</b>, <b>Orders</b>, <b>Deliveries</b>, and
          <b>Reviews</b> with integrity constraints and accurate financial history via
          <b>price_at_purchase</b>.
        </p>

        <div class="kpis">
          <div class="kpi">
            <div class="kpi-title">Normalization</div>
            <div class="kpi-value">Up to 3NF</div>
          </div>
          <div class="kpi">
            <div class="kpi-title">Integrity</div>
            <div class="kpi-value">PK/FK + checks</div>
          </div>
          <div class="kpi">
            <div class="kpi-title">Pricing</div>
            <div class="kpi-value">Captured at purchase</div>
          </div>
        </div>
      </div>

      <div class="hero-right card glow">
        <div class="card-head">
          <div>
            <div class="card-title">Quick Start</div>
            <div class="card-sub">Create a customer → restaurant → menu → place order.</div>
          </div>
          <span class="badge" id="healthBadge">API: checking…</span>
        </div>

        <ol class="steps">
          <li>Create a <b>Customer</b> user</li>
          <li>Create a <b>Restaurant</b></li>
          <li>Add <b>Menu Items</b></li>
          <li>Place an <b>Order</b> and track it</li>
        </ol>
      </div>
    </section>

    <section class="grid">
      <!-- LEFT: Actions -->
      <div class="col">
        <div class="tabs">
          <button class="tab active" data-tab="users">Users</button>
          <button class="tab" data-tab="restaurants">Restaurants</button>
          <button class="tab" data-tab="menu">Menu</button>
          <button class="tab" data-tab="orders">Orders</button>
          <button class="tab" data-tab="delivery">Delivery</button>
          <button class="tab" data-tab="reviews">Reviews</button>
        </div>

        <!-- USERS -->
        <div class="panel active" id="tab-users">
          <div class="panel-title">Create User</div>
          <form id="userForm" class="form">
            <div class="row">
              <label>Full name
                <input name="full_name" placeholder="Ayesha Khan" required />
              </label>
              <label>Type
                <select name="type" required>
                  <option>Customer</option>
                  <option>Delivery Agent</option>
                  <option>Admin</option>
                </select>
              </label>
            </div>

            <div class="row">
              <label>Email
                <input name="email" type="email" placeholder="ayesha@example.com" required />
              </label>
              <label>Phone
                <input name="phone_number" placeholder="+92..." required />
              </label>
            </div>

            <label>Address (optional)
              <input name="address" placeholder="House #, Street, City" />
            </label>

            <button class="btn primary" type="submit">Create user</button>
            <pre class="out" id="userOut"></pre>
          </form>
        </div>

        <!-- RESTAURANTS -->
        <div class="panel" id="tab-restaurants">
          <div class="panel-title">Create Restaurant</div>
          <form id="restaurantForm" class="form">
            <label>Name
              <input name="name" placeholder="Spice Hub" required />
            </label>
            <label>Address
              <input name="address" placeholder="Main Road, City" required />
            </label>
            <label>Status
              <select name="status">
                <option>Active</option>
                <option>Inactive</option>
              </select>
            </label>

            <button class="btn primary" type="submit">Create restaurant</button>
            <pre class="out" id="restaurantOut"></pre>
          </form>
        </div>

        <!-- MENU -->
        <div class="panel" id="tab-menu">
          <div class="panel-title">Add Menu Item</div>
          <form id="menuForm" class="form">
            <label>Restaurant
              <select name="restaurant_id" id="menuRestaurantSelect"></select>
            </label>

            <div class="row">
              <label>Item name
                <input name="name" placeholder="Chicken Biryani" required />
              </label>
              <label>Category
                <select name="category">
                  <option value="Food">Food</option>
                  <option value="Drink">Drink</option>
                </select>
              </label>
            </div>

            <div class="row">
              <label>Price
                <input name="price" type="number" step="0.01" placeholder="499.00" required />
              </label>
              <label class="check">
                <input name="availability" type="checkbox" checked />
                Available
              </label>
            </div>

            <button class="btn primary" type="submit">Add menu item</button>
            <pre class="out" id="menuOut"></pre>
          </form>

          <div class="divider"></div>

          <div class="panel-title">View Menu</div>
          <div class="form">
            <label>Restaurant
              <select id="viewMenuRestaurantSelect"></select>
            </label>
            <button class="btn" id="loadMenuBtn" type="button">Load menu</button>
            <div class="list" id="menuList"></div>
          </div>
        </div>

        <!-- ORDERS -->
        <div class="panel" id="tab-orders">
          <div class="panel-title">Place Order</div>
          <form id="orderForm" class="form">
            <div class="row">
              <label>Customer ID
                <input name="user_id" type="number" placeholder="1" required />
              </label>
              <label>Payment method
                <select name="payment_method" required>
                  <option value="COD">COD</option>
                  <option value="Online">Online</option>
                </select>
              </label>
            </div>

            <label>Restaurant
              <select name="restaurant_id" id="orderRestaurantSelect"></select>
            </label>

            <label>Delivery instructions
              <input name="delivery_instructions" placeholder="Leave at reception" />
            </label>

            <div class="orderbox">
              <div class="orderbox-head">
                <div>
                  <div class="orderbox-title">Items</div>
                  <div class="orderbox-sub">Select from the restaurant menu</div>
                </div>
                <button class="btn tiny" id="addItemBtn" type="button">+ Add item</button>
              </div>

              <div id="orderItemsWrap"></div>
            </div>

            <button class="btn primary" type="submit">Place order</button>
            <pre class="out" id="orderOut"></pre>
          </form>

          <div class="divider"></div>

          <div class="panel-title">Track Order</div>
          <form id="trackForm" class="form">
            <div class="row">
              <label>Order ID
                <input name="order_id" type="number" placeholder="1" required />
              </label>
              <label>Status update (optional)
                <select name="status">
                  <option value="">—</option>
                  <option>Accepted</option>
                  <option>Preparing</option>
                  <option>Out for Delivery</option>
                  <option>Delivered</option>
                  <option>Cancelled</option>
                </select>
              </label>
            </div>
            <div class="row">
              <button class="btn" type="submit">Fetch order</button>
              <button class="btn warn" id="updateStatusBtn" type="button">Update status</button>
            </div>
            <pre class="out" id="trackOut"></pre>
          </form>
        </div>

        <!-- DELIVERY -->
        <div class="panel" id="tab-delivery">
          <div class="panel-title">Assign Delivery Agent</div>
          <form id="deliveryForm" class="form">
            <div class="row">
              <label>Order ID
                <input name="order_id" type="number" placeholder="1" required />
              </label>
              <label>Delivery Agent ID
                <input name="delivery_agent_id" type="number" placeholder="Create a user with type Delivery Agent" required />
              </label>
            </div>
            <label>Expected drop time (optional)
              <input name="expected_drop_at" placeholder="2026-01-02 12:30:00" />
            </label>

            <button class="btn primary" type="submit">Assign</button>
            <pre class="out" id="deliveryOut"></pre>
          </form>
        </div>

        <!-- REVIEWS -->
        <div class="panel" id="tab-reviews">
          <div class="panel-title">Create Review</div>
          <form id="reviewForm" class="form">
            <div class="row">
              <label>Reviewer (Customer ID)
                <input name="reviewer_id" type="number" placeholder="1" required />
              </label>
              <label>Rating (1–5)
                <input name="rating" type="number" min="1" max="5" placeholder="5" required />
              </label>
            </div>

            <div class="segmented">
              <button type="button" class="seg active" data-target="restaurant">Restaurant</button>
              <button type="button" class="seg" data-target="agent">Delivery Agent</button>
            </div>

            <div class="row" id="reviewRestaurantRow">
              <label>Restaurant ID
                <input name="restaurant_id" type="number" placeholder="1" />
              </label>
              <label class="muted">Target
                <input value="Restaurant" disabled />
              </label>
            </div>

            <div class="row hidden" id="reviewAgentRow">
              <label>Delivery Agent ID
                <input name="delivery_agent_id" type="number" placeholder="2" />
              </label>
              <label class="muted">Target
                <input value="Delivery Agent" disabled />
              </label>
            </div>

            <label>Comment (optional)
              <textarea name="comment" rows="3" placeholder="Fast delivery, hot food, great packaging."></textarea>
            </label>

            <button class="btn primary" type="submit">Submit review</button>
            <pre class="out" id="reviewOut"></pre>
          </form>
        </div>
      </div>

      <!-- RIGHT: Live data -->
      <div class="col">
        <div class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Live Data</div>
              <div class="card-sub">Pulled from your Flask API</div>
            </div>
            <span class="badge soft" id="countsBadge">—</span>
          </div>

          <div class="split">
            <div class="mini">
              <div class="mini-title">Users</div>
              <div class="mini-body" id="usersList"></div>
            </div>
            <div class="mini">
              <div class="mini-title">Restaurants</div>
              <div class="mini-body" id="restaurantsList"></div>
            </div>
          </div>
        </div>

        <div class="card subtle">
          <div class="card-title">Design notes</div>
          <ul class="bullets">
            <li><b>OrderItems</b> stores <b>price_at_purchase</b> so totals remain accurate after menu price changes.</li>
            <li><b>Reviews</b> is polymorphic: review a restaurant OR an agent (exactly one FK set).</li>
            <li>Role integrity is enforced via triggers (e.g., only Customers can place orders).</li>
          </ul>
        </div>
      </div>
    </section>

    <footer class="footer">
      Flask + MySQL Workbench schema • Modern UI demo
    </footer>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>